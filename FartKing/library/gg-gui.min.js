var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},GGGui;!function(a){var b;!function(a){a[a.NONE=0]="NONE",a[a.IMAGE=1]="IMAGE",a[a.BUTTON=2]="BUTTON",a[a.PANEL=3]="PANEL",a[a.TEXT=4]="TEXT",a[a.SCROLLVIEW=5]="SCROLLVIEW",a[a.SCROLLBAR=6]="SCROLLBAR"}(b=a.GUITYPE||(a.GUITYPE={}));var c=function(){function c(b,c){this._game=b.game,this._parent=b.parent,this._group=b.group,this._guiView=b.guiView,this._guiObjectData=c,this._children=[],this._transform=new a.GuiTransform(this._game,this,c.transform),this._tween=new a.GuiTween}return c.prototype.createChildren=function(){var a=this;this._guiObjectData.children.forEach(function(b){a.createGuiObject(b)})},c.prototype.createGuiObject=function(d){var e,f={game:this._game,guiView:this._guiView,parent:this,group:this._group};switch(d.type){case b.IMAGE:e=new a.GuiImage(f,d);break;case b.BUTTON:e=new a.GuiButtonImage(f,d);break;case b.PANEL:e=new a.GuiPanel(f,d);break;case b.TEXT:e=new a.GuiText(f,d);break;case b.SCROLLVIEW:e=new a.GuiScrollView(f,d);break;case b.SCROLLBAR:e=new a.GuiScrollBar(f,d);break;case b.NONE:break;default:e=new c(f,d)}this._children.push(e),e.createChildren()},c.prototype.createComplete=function(){this._children.forEach(function(a){a.createComplete()})},c.prototype.exportGuiObject=function(){var a=[];return this.children.forEach(function(b){a.push(b.exportGuiObject())}),{transform:this.transform.exportTransform(),name:this.name,type:this._guiObjectData.type,children:a}},c.prototype.findNameInChildren=function(a){for(var b=0,c=this._children.length;b<c;b++){var d=this._children[b];if(d.name===a)return d;var e=d.findNameInChildren(a);if(e)return e}return null},c.prototype.getAllGuiObjects=function(){var a=[];return this.children.forEach(function(b){b.getAllGuiObjects().forEach(function(b){a.push(b)}),a.push(b)}),a},c.prototype.updateTransform=function(){this._children.forEach(function(a){a.updateTransform()})},c.prototype.update=function(){this._children.length>0&&this._children.forEach(function(a){a.update()})},c.prototype.resize=function(){this._children.forEach(function(a){a.resize()})},c.prototype.toTop=function(){},c.prototype.destroy=function(){this._children.forEach(function(a){a.destroy()}),this._transform.destroy(),this._tween.destroy(),this._guiObjectData=null,this._children=null,this._transform=null,this._tween=null,this._game=null,this._parent=null,this._group=null,this._guiView=null},Object.defineProperty(c.prototype,"tween",{get:function(){return this._tween},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"transform",{get:function(){return this._transform},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"name",{get:function(){return this._guiObjectData.name},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"group",{get:function(){return this._group},enumerable:!0,configurable:!0}),c}();a.GuiObject=c}(GGGui||(GGGui={}));var GGGui;!function(a){var b=function(b){function c(a,c){var d=b.call(this,a,c)||this;return d}return __extends(c,b),c.prototype.createGuiView=function(b,c){return new a.GuiView(this.game,c,b)},c}(Phaser.Plugin);a.GuiPlugin=b}(GGGui||(GGGui={}));var GGGui;!function(a){var b=function(b){function c(a,c){var d=b.call(this,a,c)||this;return d._imageData=c,d.createImage(),d}return __extends(c,b),c.prototype.updateTransform=function(){this.fitImage(),this.positionButton(),b.prototype.updateTransform.call(this)},c.prototype.resize=function(){this.setCorrectButton(),this.fitImage(),this.positionButton(),b.prototype.resize.call(this)},c.prototype.toTop=function(){this._button.bringToTop()},c.prototype.createImage=function(){var a=this.transform.getPosition();this._button=this._game.add.button(a.x,a.y,null,null,null,null,null,null,null,this.group),this.setCorrectButton(),this.fitImage(),this.positionButton()},c.prototype.setCorrectButton=function(){a.Helper.orientation()===a.ORIENTATION.PORTRAIT?(this._imageData.portraitImageData.sheet?(this._button.loadTexture(this._imageData.portraitImageData.sheet),this._button.setFrames(this._imageData.portraitImageData.key+"2",this._imageData.portraitImageData.key+"0",this._imageData.portraitImageData.key+"1",this._imageData.portraitImageData.key+"0"),this._button.frameName=this._imageData.portraitImageData.key+"0"):this._button.loadTexture(this._imageData.portraitImageData.key),this._button.anchor.set(this._imageData.portraitImageData.anchor.x||0,this._imageData.portraitImageData.anchor.y||0)):(this._imageData.landscapeImageData.sheet?(this._button.loadTexture(this._imageData.landscapeImageData.sheet),this._button.setFrames(this._imageData.landscapeImageData.key+"2",this._imageData.landscapeImageData.key+"0",this._imageData.landscapeImageData.key+"1",this._imageData.landscapeImageData.key+"0"),this._button.frameName=this._imageData.landscapeImageData.key+"0"):this._button.loadTexture(this._imageData.landscapeImageData.key),this._button.anchor.set(this._imageData.landscapeImageData.anchor.x||0,this._imageData.landscapeImageData.anchor.y||0))},c.prototype.setButton=function(a,b){this._imageData.portraitImageData=b,this._imageData.landscapeImageData=a,this.setCorrectButton(),this.fitImage(),this.positionButton()},c.prototype.fitImage=function(){this._button.scale.set(1,1),this._imageData.aspectRatio&&(this._button.scale=this.transform.calculateScaleFromSize(new Phaser.Point(this._button.width,this._button.height))),this._imageData.fill&&(this._button.scale=this.transform.calculateFillFromSize(new Phaser.Point(this._button.width,this._button.height))),this._imageData.fill||this._imageData.aspectRatio||(this._button.scale=this.transform.calculateScaleFromSize(new Phaser.Point(this._button.width,this._button.height)))},c.prototype.positionButton=function(){var a=this.transform.getPosition();this._button.position.set(a.x,a.y)},c.prototype.exportGuiObject=function(){var a=b.prototype.exportGuiObject.call(this);a.landscapeImageData.anchor.x=this._imageData.landscapeImageData.anchor.x,a.landscapeImageData.anchor.y=this._imageData.landscapeImageData.anchor.y,a.landscapeImageData.key=this._imageData.landscapeImageData.key,a.landscapeImageData.sheet=this._imageData.landscapeImageData.sheet,a.portraitImageData.anchor.x=this._imageData.portraitImageData.anchor.x,a.portraitImageData.anchor.y=this._imageData.portraitImageData.anchor.y,a.portraitImageData.key=this._imageData.portraitImageData.key,a.portraitImageData.sheet=this._imageData.portraitImageData.sheet,a.fill=this._imageData.fill,a.aspectRatio=this._imageData.aspectRatio},c.prototype.destroy=function(){this._button.destroy(),this._button=null,this._imageData=null,b.prototype.destroy.call(this)},Object.defineProperty(c.prototype,"button",{get:function(){return this._button},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"landscapeImageData",{get:function(){return this._imageData.landscapeImageData},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"portraitImageData",{get:function(){return this._imageData.portraitImageData},enumerable:!0,configurable:!0}),c}(a.GuiObject);a.GuiButtonImage=b}(GGGui||(GGGui={}));var GGGui;!function(a){var b;!function(a){a[a.LANDSCAPE=0]="LANDSCAPE",a[a.PORTRAIT=1]="PORTRAIT"}(b=a.ORIENTATION||(a.ORIENTATION={}));var c=function(){function c(b,c,d){var e=this;this._game=b,this._guiObject=c,this._transformData=d,this.positionOffset=new a.Point,this.positionOffset.onChange.add(function(){e._guiObject.updateTransform()},this),this.scaleOffset=new a.Point(1,1),this.scaleOffset.onChange.add(function(){e._guiObject.updateTransform()})}return c.prototype.getTransformSize=function(){var c,d,e=new Phaser.Point;return a.Helper.orientation()===b.LANDSCAPE?(c=this.percentToPosition(new Phaser.Point(this._transformData.anchorLandscape.anchorTopLeft.x,this._transformData.anchorLandscape.anchorTopLeft.y)),d=this.percentToPosition(new Phaser.Point(this._transformData.anchorLandscape.anchorBottomRight.x,this._transformData.anchorLandscape.anchorBottomRight.y))):(c=this.percentToPosition(new Phaser.Point(this._transformData.anchorPortrait.anchorTopLeft.x,this._transformData.anchorPortrait.anchorTopLeft.y)),d=this.percentToPosition(new Phaser.Point(this._transformData.anchorPortrait.anchorBottomRight.x,this._transformData.anchorPortrait.anchorBottomRight.y))),e.x=d.x-c.x,e.y=d.y-c.y,e},c.prototype.getTopLeft=function(){var c;return a.Helper.orientation()===b.LANDSCAPE?(c=new Phaser.Point(this._transformData.anchorLandscape.anchorTopLeft.x,this._transformData.anchorLandscape.anchorTopLeft.y),this.percentToPosition(c)):(c=new Phaser.Point(this._transformData.anchorPortrait.anchorTopLeft.x,this._transformData.anchorPortrait.anchorTopLeft.y),this.percentToPosition(c))},c.prototype.calculateScaleFromSize=function(a){var b=this.getTransformSize(),c=b.x/a.x,d=b.y/a.y,e=Math.min(c,d);return new Phaser.Point(e*this.scaleOffset.x,e*this.scaleOffset.y)},c.prototype.calculateFillFromSize=function(a){var b=this.getTransformSize(),c=b.x/a.x,d=b.y/a.y;return new Phaser.Point(c*this.scaleOffset.x,d*this.scaleOffset.y)},c.prototype.getPosition=function(){var a=this.getTopLeft(),b=this.getTransformSize(),c=this.getAlignment();return new Phaser.Point(a.x+b.x*c.x,a.y+b.y*c.y)},c.prototype.percentToPosition=function(a){if(this._guiObject.parent){var b=this._guiObject.parent.transform.getTransformSize(),c=this._guiObject.parent.transform.getTopLeft();return new Phaser.Point(this.positionOffset.x+(c.x+b.x*a.x),this.positionOffset.y+(c.y+b.y*a.y))}return new Phaser.Point(this.positionOffset.x+this._game.width*a.x,this.positionOffset.y+this._game.height*a.y)},c.prototype.getAlignment=function(){return a.Helper.orientation()===b.LANDSCAPE?new Phaser.Point(this._transformData.anchorLandscape.alignment.x,this._transformData.anchorLandscape.alignment.y):new Phaser.Point(this._transformData.anchorPortrait.alignment.x,this._transformData.anchorPortrait.alignment.y)},c.prototype.exportTransform=function(){return{anchorLandscape:this._transformData.anchorLandscape,anchorPortrait:this._transformData.anchorPortrait,layer:this._transformData.layer}},c.prototype.destroy=function(){this.positionOffset.destroy(),this.scaleOffset.destroy(),this._game=null,this._guiObject=null,this._transformData=null,this.positionOffset=null,this.scaleOffset=null},Object.defineProperty(c.prototype,"layer",{get:function(){return this._transformData.layer},enumerable:!0,configurable:!0}),c}();a.GuiTransform=c}(GGGui||(GGGui={}));var GGGui;!function(a){var b=function(){function a(){}return a.prototype.destroy=function(){},a}();a.GuiTween=b}(GGGui||(GGGui={}));var GGGui;!function(a){var b=function(){function b(a,b,c){this._guiObjects=[],this._game=a,this._group=b,this.createGui(c),this.sortLayers()}return b.prototype.createGui=function(a){var b=this;a.guiObjects.forEach(function(a){b.createGuiObject(a)}),this._guiObjects.forEach(function(a){a.createComplete()})},b.prototype.createGuiObject=function(b){var c,d={game:this._game,guiView:this,parent:null,group:this._group};switch(b.type){case a.GUITYPE.IMAGE:c=new a.GuiImage(d,b);break;case a.GUITYPE.BUTTON:c=new a.GuiButtonImage(d,b);break;case a.GUITYPE.PANEL:c=new a.GuiPanel(d,b);break;case a.GUITYPE.TEXT:c=new a.GuiText(d,b);break;case a.GUITYPE.SCROLLVIEW:c=new a.GuiScrollView(d,b);break;case a.GUITYPE.SCROLLBAR:c=new a.GuiScrollBar(d,b);break;case a.GUITYPE.NONE:break;default:c=new a.GuiObject(d,b)}this._guiObjects.push(c),c.createChildren()},b.prototype.findByName=function(a){for(var b=0,c=this._guiObjects.length;b<c;b++){var d=this._guiObjects[b];if(d.name===a)return d;var e=d.findNameInChildren(a);if(e)return e}return null},b.prototype.getAllGuiObjects=function(){var a=[];return this._guiObjects.forEach(function(b){b.getAllGuiObjects().forEach(function(b){a.push(b)}),a.push(b)}),a},b.prototype.disableInput=function(){var b=this.getAllGuiObjects();b.forEach(function(b){b instanceof a.GuiButtonImage&&(b.button.inputEnabled=!1)})},b.prototype.enableInput=function(){var b=this.getAllGuiObjects();b.forEach(function(b){b instanceof a.GuiButtonImage&&(b.button.inputEnabled=!0)})},b.prototype.update=function(){this._guiObjects.forEach(function(a){a.update()})},b.prototype.resize=function(){this._guiObjects.forEach(function(a){a.resize()}),this.sortLayers()},b.prototype.sortLayers=function(){for(var a=this.getAllGuiObjects(),b=0,c=[],d=0;d<a.length;d++)a[d].transform.layer>b&&(b=a[d].transform.layer);for(var e=0;e<=b;e++)c.push([]);for(var f=0;f<a.length;f++)c[a[f].transform.layer].push(a[f]);for(var g=0;g<c.length;g++)for(var h=0;h<c[g].length;h++)c[g][h].toTop();c=null,b=null},b.prototype.exportGuiView=function(){var a=[];return this._guiObjects.forEach(function(b){a.push(b.exportGuiObject())}),{guiObjects:a}},b.prototype.destroy=function(){this._guiObjects.forEach(function(a){a.destroy()}),this._guiObjects=null,this._game=null,this._group=null},Object.defineProperty(b.prototype,"group",{get:function(){return this._group},enumerable:!0,configurable:!0}),b}();a.GuiView=b}(GGGui||(GGGui={}));var GGGui;!function(a){var b=function(b){function c(a,c){var d=b.call(this,a,c)||this;return d._imageData=c,d.createImage(),d}return __extends(c,b),c.prototype.updateTransform=function(){this.fitImage(),this.positionImage(),b.prototype.updateTransform.call(this)},c.prototype.resize=function(){this.fitImage(),this.positionImage(),b.prototype.resize.call(this)},c.prototype.toTop=function(){this._image.bringToTop()},c.prototype.createImage=function(){var a=this.transform.getPosition();this._image=this._game.add.image(a.x,a.y,null,null,this.group),this.setCorrectImage(),this.fitImage(),this.positionImage()},c.prototype.setCorrectImage=function(){a.Helper.orientation()===a.ORIENTATION.PORTRAIT?(this._imageData.portraitImageData.sheet?this._image.loadTexture(this._imageData.portraitImageData.sheet,this._imageData.portraitImageData.key):this._image.loadTexture(this._imageData.portraitImageData.key),this._image.anchor.set(this._imageData.portraitImageData.anchor.x||0,this._imageData.portraitImageData.anchor.y||0)):(this._imageData.landscapeImageData.sheet?this._image.loadTexture(this._imageData.landscapeImageData.sheet,this._imageData.landscapeImageData.key):this._image.loadTexture(this._imageData.landscapeImageData.key),this._image.anchor.set(this._imageData.landscapeImageData.anchor.x||0,this._imageData.landscapeImageData.anchor.y||0))},c.prototype.setImage=function(a,b){this._imageData.portraitImageData=a,this._imageData.landscapeImageData=b,this.setCorrectImage(),this.fitImage(),this.positionImage()},c.prototype.fitImage=function(){this._image.scale.set(1,1),this._imageData.aspectRatio&&(this._image.scale=this.transform.calculateScaleFromSize(new Phaser.Point(this._image.width,this._image.height))),this._imageData.fill&&(this._image.scale=this.transform.calculateFillFromSize(new Phaser.Point(this._image.width,this._image.height))),this._imageData.fill||this._imageData.aspectRatio||(this._image.scale=this.transform.calculateScaleFromSize(new Phaser.Point(this._image.width,this._image.height)))},c.prototype.positionImage=function(){var a=this.transform.getPosition();this._image.position.set(a.x,a.y)},c.prototype.exportGuiObject=function(){var a=b.prototype.exportGuiObject.call(this);a.landscapeImageData.anchor.x=this._imageData.landscapeImageData.anchor.x,a.landscapeImageData.anchor.y=this._imageData.landscapeImageData.anchor.y,a.landscapeImageData.key=this._imageData.landscapeImageData.key,a.landscapeImageData.sheet=this._imageData.landscapeImageData.sheet,a.portraitImageData.anchor.x=this._imageData.portraitImageData.anchor.x,a.portraitImageData.anchor.y=this._imageData.portraitImageData.anchor.y,a.portraitImageData.key=this._imageData.portraitImageData.key,a.portraitImageData.sheet=this._imageData.portraitImageData.sheet,a.fill=this._imageData.fill,a.aspectRatio=this._imageData.aspectRatio},c.prototype.destroy=function(){this._image.destroy(),this._image=null,this._imageData=null,b.prototype.destroy.call(this)},Object.defineProperty(c.prototype,"image",{get:function(){return this._image},enumerable:!0,configurable:!0}),c}(a.GuiObject);a.GuiImage=b}(GGGui||(GGGui={}));var GGGui;!function(a){var b=function(a){function b(b,c){var d=a.call(this,b,c)||this;return d._panelData=c,d.createNineSlice(),d}return __extends(b,a),b.prototype.toTop=function(){this._panel.bringToTop()},b.prototype.createNineSlice=function(){var a=this.transform.getPosition(),b=this.transform.getTransformSize();this._panelData.sheet?(this._panel=new PhaserNineSlice.NineSlice(this._game,a.x,a.y,this._panelData.sheet,this._panelData.key,b.x,b.y,{top:this._panelData.top||10,bottom:this._panelData.bottom||10,left:this._panelData.left||10,right:this._panelData.right||10}),this._game.add.existing(this._panel),this.group.add(this._panel)):this._panel=this._game.add.nineSlice(a.x,a.y,this._panelData.key,null,b.x,b.y,this.group),this._panel.anchor.set(this._panelData.anchor.x||0,this._panelData.anchor.y||0)},b.prototype.fitPanel=function(){var a=this.transform.getTransformSize();a.x===this._panel.width&&a.y===this._panel.height||this._panel.resize(a.x,a.y)},b.prototype.positionPanel=function(){var a=this.transform.getPosition();this._panel.x=a.x,this._panel.y=a.y},b.prototype.exportPanel=function(){var b=a.prototype.exportGuiObject.call(this);return b.anchor.x=this._panel.anchor.x,b.anchor.y=this._panel.anchor.y,b.key=this._panel.key,b.sheet=this._panel.frameName,b.top=this._panel.top,b.bottom=this._panel.bottom,b.left=this._panel.left,b.right=this._panel.right,b},b.prototype.resize=function(){this.fitPanel(),this.positionPanel(),a.prototype.resize.call(this)},b.prototype.updateTransform=function(){this.fitPanel(),this.positionPanel(),a.prototype.updateTransform.call(this)},b.prototype.destroy=function(){this._panel.destroy(),this._panelData=null,this._panel=null,a.prototype.destroy.call(this)},b}(a.GuiObject);a.GuiPanel=b}(GGGui||(GGGui={}));var GGGui;!function(a){var b;!function(a){a[a.LEFT=0]="LEFT",a[a.RIGHT=1]="RIGHT",a[a.TOP=2]="TOP",a[a.BOTTOM=3]="BOTTOM"}(b=a.TRACKLOCATION||(a.TRACKLOCATION={}));var c=function(b){function c(a,c){var d=b.call(this,a,c)||this;return d._guiScrollBarExport=c,d._trackPiecePercentage=0,d.createBar(),d.renderBar(),d.createTrackPiece(),d}return __extends(c,b),c.prototype.updateTransform=function(){this.setPosition(),b.prototype.updateTransform.call(this)},c.prototype.resize=function(){this.renderBar(),this.setPosition(),this.setTrackPiece(this._trackPiecePercentage),b.prototype.resize.call(this)},c.prototype.toTop=function(){this._scrollbar.bringToTop()},c.prototype.createBar=function(){var b=this.getTextureAndFrame(this._guiScrollBarExport.horizontalBar.key,this._guiScrollBarExport.horizontalBar.sheet);this._horizontalBaseTexture=b.baseTexture,this._horizontalFrame=b.frame,b=this.getTextureAndFrame(this._guiScrollBarExport.verticalBar.key,this._guiScrollBarExport.verticalBar.sheet),this._verticalBaseTexture=b.baseTexture,this._verticalFrame=b.frame,b=null;var c=this.transform.getTransformSize(),d=this._guiScrollBarExport.segmentSize;this._scrollbar=this._game.add.sprite(0,0,null,null,this.group),this.scrollDirection===a.SCROLLDIRECTION.HORIZONTAL?this._scrollbar.loadTexture(new Phaser.RenderTexture(this._game,c.x,d)):this._scrollbar.loadTexture(new Phaser.RenderTexture(this._game,d,c.y)),this._texture=this._scrollbar.texture},c.prototype.getTextureAndFrame=function(a,b){var c;c=b?this._game.add.sprite(-1e4,-1e4,b,a):this._game.add.sprite(-1e4,-1e4,a,null);var d={baseTexture:c.texture.baseTexture,frame:c.texture.frame};return c.destroy(),d},c.prototype.createTrackPiece=function(){this._guiScrollBarExport.trackPieceSheet?this._trackPiece=this._game.add.image(0,0,this._guiScrollBarExport.trackPieceSheet,this._guiScrollBarExport.trackPieceKey,this.group):this._trackPiece=this._game.add.image(0,0,this._guiScrollBarExport.trackPieceKey,null,this.group),this._trackPiece.anchor.set(.5,.5),this._scrollbar.addChild(this._trackPiece),this.setTrackPiece(0)},c.prototype.renderBar=function(){var b=0,c=this.transform.getTransformSize(),d=this._guiScrollBarExport.segmentSize,e=0,f=this._guiScrollBarExport.segmentSize,g=2*this._guiScrollBarExport.segmentSize;this._texture.clear(),this.scrollDirection===a.SCROLLDIRECTION.HORIZONTAL?(b=c.x,this._texture.resize(c.x,d,!0)):(b=c.y,this._texture.resize(d,c.y,!0));for(var h=0,i=Math.ceil((b-2*d)/d);h<i;h++)this.scrollDirection===a.SCROLLDIRECTION.HORIZONTAL?this._texture.renderXY(this.createTexturePart(f,0,d,d),h*d+d,0):this._texture.renderXY(this.createTexturePart(0,f,d,d),0,h*d+d);this.scrollDirection===a.SCROLLDIRECTION.HORIZONTAL?(this._texture.renderXY(this.createTexturePart(e,0,d,d),0,0),this._texture.renderXY(this.createTexturePart(g,0,d,d),b-d,0)):(this._texture.renderXY(this.createTexturePart(0,e,d,d),0,0),this._texture.renderXY(this.createTexturePart(0,g,d,d),0,b-d)),this.setPosition()},c.prototype.createTexturePart=function(b,c,d,e){if(this.scrollDirection===a.SCROLLDIRECTION.HORIZONTAL){var f=new PIXI.Rectangle(this._horizontalFrame.x+this._texture.frame.x+b,this._horizontalFrame.y+this._texture.frame.y+c,Math.max(d,1),Math.max(e,1));return new Phaser.Sprite(this._game,0,0,new PIXI.Texture(this._horizontalBaseTexture,f))}var f=new PIXI.Rectangle(this._verticalFrame.x+this._texture.frame.x+b,this._verticalFrame.y+this._texture.frame.y+c,Math.max(d,1),Math.max(e,1));return new Phaser.Sprite(this._game,0,0,new PIXI.Texture(this._verticalBaseTexture,f))},c.prototype.setPosition=function(){var b=this.transform.getPosition();this.scrollDirection===a.SCROLLDIRECTION.HORIZONTAL?this._scrollbar.anchor.set(this._guiScrollBarExport.horizontalBar.anchor.x,this._guiScrollBarExport.horizontalBar.anchor.y):this._scrollbar.anchor.set(this._guiScrollBarExport.verticalBar.anchor.x,this._guiScrollBarExport.verticalBar.anchor.y),this._scrollbar.position.set(b.x,b.y)},c.prototype.setTrackPiece=function(b){this._trackPiecePercentage=b,this.scrollDirection===a.SCROLLDIRECTION.HORIZONTAL?this._trackPiece.position.set(Phaser.Math.clamp(this._texture.width*b,this._guiScrollBarExport.segmentSize/2,this._texture.width-this._guiScrollBarExport.segmentSize/2),0-this._scrollbar.anchor.y/2*this._scrollbar.height):this._trackPiece.position.set(0-this._scrollbar.anchor.x/2*this._scrollbar.width,Phaser.Math.clamp(this._texture.height*b,this._guiScrollBarExport.segmentSize/2,this._texture.height-this._guiScrollBarExport.segmentSize/2))},c.prototype.destroy=function(){this._trackPiece.destroy(),this._scrollbar.destroy(),this._guiScrollBarExport=null,this._scrollbar=null,this._trackPiece=null,this._horizontalBaseTexture=null,this._horizontalFrame=null,this._verticalBaseTexture=null,this._verticalFrame=null,this._texture=null,this._trackPiecePercentage=null,b.prototype.destroy.call(this)},Object.defineProperty(c.prototype,"scrollDirection",{get:function(){var b=this.transform.getTransformSize();return b.x>b.y?a.SCROLLDIRECTION.HORIZONTAL:a.SCROLLDIRECTION.VERTICAL},enumerable:!0,configurable:!0}),c}(a.GuiObject);a.GuiScrollBar=c}(GGGui||(GGGui={}));var GGGui;!function(a){var b;!function(a){a[a.VERTICAL=0]="VERTICAL",a[a.HORIZONTAL=1]="HORIZONTAL"}(b=a.SCROLLDIRECTION||(a.SCROLLDIRECTION={}));var c=function(a){function c(b,c){var d=a.call(this,b,c)||this;return d.onClick=new Phaser.Signal,d._mousePosition=new Phaser.Point,d._mouseDown=!1,d._velocity=0,d._autoScroll=!1,d._scrollTime=400,d._scrollBarName=c.scrollBarName,d._scrollPercentage=0,d._scrollOffset=0,d._scrollSensitivity=c.scrollSensitivity,d}return __extends(c,a),c.prototype.createComplete=function(){this._scrollBar=this._guiView.findByName(this._scrollBarName),a.prototype.createComplete.call(this)},c.prototype.updateTransform=function(){this.positionBaseGraphic(),this.positionMask(),a.prototype.updateTransform.call(this)},c.prototype.update=function(){if(a.prototype.update.call(this),this._baseGraphic){if(this._autoScroll){var b=this._timeStamp-Date.now(),c=this._amplitude*Math.exp(b/this._scrollTime);Math.abs(c)>1?this.scroll(c):this._autoScroll=!1}this._scrollBar&&this._scrollBar.setTrackPiece(this.scrollPercentage),this.scaleImages()}},c.prototype.resize=function(){(this._baseGraphic||this._maskGraphic)&&(this._scrollDirection=this.scrollDirection,this.resizeBaseGraphic(),this.positionIcons(),this.resizeMask(),a.prototype.resize.call(this),this.scrollPercentage=this._scrollPercentage)},c.prototype.toTop=function(){this._baseGraphic&&this.group.bringToTop(this._baseGraphic),this._maskGraphic&&this.group.bringToTop(this._maskGraphic)},c.prototype.createView=function(a,b,c){var d=this;this.clearIcons(),this._scrollDirection=this.scrollDirection,this._imageSize=b,this._imageSpacing=c,this._scrollPercentage=0,this._scrollOffset=0,this._amplitude=0,this._autoScroll=!1,a.forEach(function(a){var b;b=a.sheet?d._game.add.image(0,0,a.sheet,a.key,d.group):d._game.add.image(0,0,a.key,null,d.group),b.anchor.set(.5,.5),d._images.push({id:a.id,image:b})}),this.createBaseGraphic(),this._images.forEach(function(a){d._baseGraphic.addChild(a.image)}),this.positionIcons(),this.createMask()},c.prototype.clearIcons=function(){var a=this;this._images&&this._images.forEach(function(b){a._baseGraphic.removeChild(b.image),b.image.destroy()}),this._images=[]},c.prototype.positionIcons=function(){if(this._images)if(this._images.forEach(function(a){a.image.position.set(0,0),a.image.scale.set(1,1)}),this._scrollDirection===b.HORIZONTAL)for(var a=0,c=this._images.length;a<c;a++){var d=this._images[a].image;d.position.x=this._imageSize.x*a+this._imageSpacing*a+this._imageSpacing+d.width/2,d.position.y=d.height/2}else for(var a=0,c=this._images.length;a<c;a++){var d=this._images[a].image;d.x=d.width/2,d.position.y=this._imageSize.y*a+this._imageSpacing*a+this._imageSpacing+d.height/2}},c.prototype.createBaseGraphic=function(){if(this._baseGraphic)return void this.resizeBaseGraphic();var a=this.transform.getPosition(),c=this.transform.getTransformSize(),d=30+this._imageSize.x*this._images.length-1+this._imageSpacing*this._images.length-1,e=30+this._imageSize.y*this._images.length-1+this._imageSpacing*this._images.length-1;this._scrollDirection===b.HORIZONTAL?e=this._imageSize.y:d=this._imageSize.x,this._baseGraphic=this._game.add.graphics(a.x,a.y,this.group),this._baseGraphic.beginFill(0,0),this._baseGraphic.drawRect(0,0,d,e),this._baseGraphic.endFill();var f=new Phaser.Point;this._scrollDirection===b.HORIZONTAL?(f.y=c.y/e,f.x=f.y):(f.x=c.x/d,f.y=f.x),this._baseGraphic.scale.set(f.x,f.y),this.createCallbacks()},c.prototype.resizeBaseGraphic=function(){if(this._baseGraphic){var a=this.transform.getPosition(),c=this.transform.getTransformSize(),d=30+this._imageSize.x*this._images.length-1+this._imageSpacing*this._images.length-1,e=30+this._imageSize.y*this._images.length-1+this._imageSpacing*this._images.length-1;this._scrollDirection===b.HORIZONTAL?e=this._imageSize.y:d=this._imageSize.x,this._baseGraphic.clear(),this._baseGraphic.scale.set(1,1),this._baseGraphic.beginFill(0,0),this._baseGraphic.drawRect(0,0,d,e),this._baseGraphic.endFill(),this._baseGraphic.position.set(a.x,a.y);var f=new Phaser.Point;this._scrollDirection===b.HORIZONTAL?(f.y=c.y/e,f.x=f.y):(f.x=c.x/d,f.y=f.x),this._baseGraphic.scale.set(f.x,f.y)}},c.prototype.positionBaseGraphic=function(){var a=this.transform.getPosition();this._scrollDirection===b.HORIZONTAL?(this._baseGraphic.position.x=a.x-this._scrollOffset,this._baseGraphic.position.y=a.y):(this._baseGraphic.position.y=a.y-this._scrollOffset,this._baseGraphic.position.x=a.x)},c.prototype.createMask=function(){if(this._maskGraphic)return void this.resizeMask();var a=this.transform.getTransformSize();this._maskGraphic=this._game.add.graphics(0,0,this.group),this._maskGraphic.beginFill(16777215,0),this._maskGraphic.drawRect(0,0,a.x,a.y),this._maskGraphic.endFill(),this.positionMask()},c.prototype.resizeMask=function(){if(this._maskGraphic){var a=this.transform.getTransformSize();this._maskGraphic.clear(),this._maskGraphic.beginFill(16777215,0),this._maskGraphic.drawRect(0,0,a.x,a.y),this._maskGraphic.endFill(),this.positionMask()}},c.prototype.positionMask=function(){var a=this.transform.getPosition();this._maskGraphic.position.set(a.x,a.y)},c.prototype.createCallbacks=function(){var a=this;this._baseGraphic.inputEnabled=!0,this._baseGraphic.events.onInputDown.add(function(b,c){a.isMouseInMark(c.x,c.y)&&(a._mousePosition.set(c.x,c.y),a._mouseDown=!0,a._mouseClick=!0,a._velocity=0,a._amplitude=0)},this),this._baseGraphic.events.onInputUp.add(function(b,c){a.inputEnd(c.x,c.y)},this),this._baseGraphic.events.onInputOut.add(function(b,c){a.inputEnd(c.x,c.y)},this),this._game.input.addMoveCallback(function(c,d,e,f){if(a._mouseDown){var g=0;a._scrollDirection===b.HORIZONTAL?(g=a._mousePosition.x-d,a._mousePosition.x=d,a._velocity=g,a.scroll(g)):(g=a._mousePosition.y-e,a._mousePosition.y=e,a._velocity=g,a.scroll(g)),Math.abs(g)>1&&(a._mouseClick=!1)}},this),this._game.input.mouse.mouseWheelCallback=function(c){if(a.isMouseInMark(a._game.input.mousePointer.x,a._game.input.mousePointer.y)){var d=0,e=a.transform.getTransformSize(),f=void 0;a._scrollDirection===b.HORIZONTAL?(f=a._baseGraphic.width-e.x,d=.02*f):(f=a._baseGraphic.height-e.y,d=.02*f),a._game.input.mouse.wheelDelta===Phaser.Mouse.WHEEL_UP?a.scroll(-d):a.scroll(d)}}},c.prototype.isMouseInMark=function(a,b){var c=this.transform.getPosition(),d=this._maskGraphic.getLocalBounds();return d.x=c.x,d.y=c.y,!!d.contains(a,b)},c.prototype.scroll=function(a){a*=-1;var c,d=this.transform.getTransformSize(),e=this.transform.getPosition();this._scrollDirection===b.HORIZONTAL?(c=this._baseGraphic.width-d.x,this._scrollOffset-=a,this._scrollOffset=Phaser.Math.clamp(this._scrollOffset,0,c),this._baseGraphic.position.x=e.x-this._scrollOffset):(c=this._baseGraphic.height-d.y,this._scrollOffset-=a,this._scrollOffset=Phaser.Math.clamp(this._scrollOffset,0,c),this._baseGraphic.position.y=e.y-this._scrollOffset),this._scrollPercentage=this.scrollPercentage},c.prototype.inputEnd=function(a,b){if(this._mouseDown)if(this._mouseDown=!1,Math.abs(this._velocity)>this._scrollSensitivity)this._amplitude=2*this._velocity,this._autoScroll=!0,this._timeStamp=Date.now();else if(this._mouseClick){var c=this.getScrollViewImageUnderMouse(a,b);c&&this.onClick.dispatch(c.id)}},c.prototype.scaleImages=function(){var a=this;this._images.forEach(function(b){b.image.getBounds().contains(a._game.input.mousePointer.x,a._game.input.mousePointer.y)?b.image.scale.set(1.2,1.2):b.image.scale.set(1,1)})},c.prototype.getScrollViewImageUnderMouse=function(a,b){for(var c=0,d=this._images.length;c<d;c++){var e=this._images[c];if(e.image.getBounds().contains(a,b))return e}return null},c.prototype.destroy=function(){this._game.input.mouse.mouseWheelCallback=null,this.onClick.dispose(),this.onClick=null,this.clearIcons(),this._images=null,this._maskGraphic.destroy(),this._maskGraphic=null,this._baseGraphic.destroy(),this._baseGraphic=null,this._imageSpacing=null,this._imageSize=null,this._scrollDirection=null,this._mousePosition=null,this._mouseDown=null,this._velocity=null,this._amplitude=null,this._autoScroll=null,this._scrollTime=null,this._timeStamp=null,this._scrollBarName=null,this._scrollBar=null,a.prototype.destroy.call(this)},Object.defineProperty(c.prototype,"scrollDirection",{get:function(){var a=this.transform.getTransformSize();return a.x>a.y?b.HORIZONTAL:b.VERTICAL},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"scrollPercentage",{get:function(){var a,c=this.transform.getTransformSize(),d=this.transform.getPosition();return this._scrollDirection===b.HORIZONTAL?(a=this._baseGraphic.width-c.x,Number((this._baseGraphic.x/(d.x-a)).toFixed(4))):(a=this._baseGraphic.height-c.y,
Number((this._baseGraphic.y/(d.y-a)).toFixed(4)))},set:function(a){var c,d=this.transform.getTransformSize(),e=this.transform.getPosition();this._scrollDirection===b.HORIZONTAL?(c=this._baseGraphic.width-d.x,this._baseGraphic.x=e.x-c*a,this._scrollOffset=c*a):(c=this._baseGraphic.height-d.y,this._baseGraphic.y=e.y-c*a,this._scrollOffset=c*a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"images",{get:function(){return this._images},enumerable:!0,configurable:!0}),c}(a.GuiObject);a.GuiScrollView=c}(GGGui||(GGGui={}));var GGGui;!function(a){var b=function(a){function b(b,c){var d=a.call(this,b,c)||this;return d._textExport=c,d.createText(),d.scaleToFit(),d.positionText(),d}return __extends(b,a),b.prototype.updateTransform=function(){this.positionText(),a.prototype.updateTransform.call(this)},b.prototype.resize=function(){this.scaleToFit(),this.positionText(),a.prototype.resize.call(this)},b.prototype.toTop=function(){this.group.bringToTop(this._text)},b.prototype.createText=function(){this._text=this._game.add.bitmapText(0,0,this._textExport.font,this._textExport.text||"null",this._textExport.size||72,this.group),this._text.align=this._textExport.alignment||"left",this._text.anchor.set(this._textExport.anchor.x||0,this._textExport.anchor.y||0)},b.prototype.positionText=function(){var a=this.transform.getPosition();this._text.position.set(a.x,a.y)},b.prototype.setText=function(a){this._text.text!==a&&(this._text.text=a,this.transform.scaleOffset.set(1,1),this.scaleToFit())},b.prototype.scaleToFit=function(){var a=!0;if("string"!=typeof this._text.fontSize&&0!==this._text.height&&0!==this._text.width){if(this._text.height>this.transform.getTransformSize().y)for(;a;)this._text.fontSize-=1,this._text.height<this.transform.getTransformSize().y&&(a=!1);else for(;a;)this._text.fontSize+=1,(this._text.height>this.transform.getTransformSize().y||this._text.width>this.transform.getTransformSize().x)&&(this._text.fontSize-=2,a=!1);if(a=!0,this._text.width>this.transform.getTransformSize().x)for(;a;)this._text.fontSize-=1,this._text.width<this.transform.getTransformSize().x&&(a=!1);else for(;a;)this._text.fontSize+=1,(this._text.width>this.transform.getTransformSize().x||this._text.height>this.transform.getTransformSize().y)&&(this._text.fontSize-=2,a=!1)}},b.prototype.destroy=function(){this._text.destroy(),this._text=null,this._textExport=null,a.prototype.destroy.call(this)},b}(a.GuiObject);a.GuiText=b}(GGGui||(GGGui={}));var GGGui;!function(a){var b=function(){function b(){}return b.orientation=function(){return window.innerWidth>window.innerHeight?a.ORIENTATION.LANDSCAPE:a.ORIENTATION.PORTRAIT},b}();a.Helper=b}(GGGui||(GGGui={}));var GGGui;!function(a){var b=function(){function a(a,b){this._x=a||0,this._y=b||0,this.onChange=new Phaser.Signal}return Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this.onChange.dispatch()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this.onChange.dispatch()},enumerable:!0,configurable:!0}),a.prototype.set=function(a,b){this._x=a||this._x,this._y=b||this._y,this.onChange.dispatch()},a.prototype.destroy=function(){this.onChange.dispose(),this.onChange=null,this._x=null,this._y=null},a}();a.Point=b}(GGGui||(GGGui={}));